<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<link rel="stylesheet" type="text/css" href="../public/css/normalize.css">
	<link rel="stylesheet" type="text/css" href="../public/css/main.css">
	<title>常用进制转换器 BDHConterver</title>
	<style type="text/css">
		body {
			font-size: 1em;
			text-align: center;
		}

		input {
			color: #000;
		}

		/* 没有数字文本框的上下微调按钮 */
		input::-webkit-outer-spin-button,
		input::-webkit-inner-spin-button {
			-webkit-appearance: none;
		}

		.label {
			font-size: 1em;
			display: inline-block;
			width: 30%;
		}

		.textbox {
			display: inline-block;
			width: 65%;
			padding: 0.5em 0;
		}

		#btn_reset {
			text-align: center;
			font-size: 1em;
			padding: 0.5em 1em;
			background-color: #ff9;
			border: 2px solid #cc6;
		}

		#btn_reset:hover {
			background-color: #ff6;
			border: 2px solid #aa4;
		}

		#btn_reset:active {
			background-color: #aa4;
			border: 2px solid #882;
		}

		.textlab {
			display: inline-block;
			width: 30%;
		}

		p {
			font-size: 0.8em;
		}
	</style>
</head>

<body>
	<script src="../public/js/adjust_page_width.js"></script>

	<div class="header">
		<h1><a href="../index.html">QKTool</a></h1>
		<h2>常用进制转换器 BDHConterver</h2>
		<h4>版本号：1.1.0-beta</h4>
	</div>

	<div class="content">
		<form>
			<span class="label">二进制&nbsp;B</span>
			<input class="textbox" id="num_bin" type="number" placeholder="Binary" min="0" oninput="calculate(2)">
			<br><br>
			<span class="label">八进制&nbsp;O</span>
			<input class="textbox" id="num_oct" type="number" placeholder="Octal" min="0" oninput="calculate(8)">
			<br><br>
			<span class="label">十进制&nbsp;D</span>
			<input class="textbox" id="num_dec" type="number" placeholder="Decimal" min="0" oninput="calculate(10)">
			<br><br>
			<span class="label">十六进制&nbsp;H</span>
			<input class="textbox" id="num_hex" type="text" placeholder="Hexadecimal（不区分大小写）" oninput="calculate(16)">
			<br><br>
			<input type="reset" id="btn_reset" value="清除所有">
		</form>
	</div>

	<br>
	<div class="footer">
		<h3>更新日志</h3>
		<h4>版本 1.1.0-beta 日期时间 2019.03.22 05:30</h4>
		<p>增加八进制换算功能</p>
		<h4>版本 1.0.0-beta 日期时间 2019.03.21 03:00</h4>
		<p>完成二进制、十进制、十六进制互转功能</p>
		<div class="footer-copyright"></div>
	</div>
	<script src="../public/js/jquery-1.8.3.min.js"></script>
	<script>
		$(function () {
			$(document).ready(function () {
				$('.footer-copyright').load('../public/html/footer-copyright.html');
			})
		});
	</script>

	<script>
		function calculate(num_type) {
			bin = document.getElementById('num_bin');
			oct = document.getElementById('num_oct');
			dec = document.getElementById('num_dec');
			hex = document.getElementById('num_hex');
			switch (num_type) {
				case 2:
					bin_to_oct(); //二进制转八进制，取三合一
					bin_to_dec(); //二进制转十进制，按2次幂的权展开累加
					bin_to_hex(); //二进制转十六进制，取四合一
					break;
				case 8:
					oct_to_bin(); //八进制转二进制，取一分三
					oct_to_dec(); //八进制转十进制，取上文二进制结果，按2次幂的权展开累加
					oct_to_hex(); //八进制转十六进制，取上文二进制结果，取四合一
					break;
				case 10:
					dec_to_bin(); //十进制转二进制，短除法取余
					dec_to_oct(); //十进制转八进制，取上文二进制结果，取三合一
					dec_to_hex(); //十进制转十六进制，取上文二进制结果，取四合一
					break;
				case 16:
					hex_to_bin(); //十六进制转二进制，取一分四
					hex_to_oct(); //十六进制转八进制，取上文二进制结果，取三合一
					hex_to_dec(); //十六进制转十进制，取上文二进制结果，按2幂权累加
					break;
				default:
					break;
			}
		}

		function bin_to_oct() {
			var bin_str, //二进制字符串，直接来自于文本框
				bin_len, //二进制字符串的长度
				tmp_oct_str, //当前3位一组二进制的字符串
				tmp_oct_str; //当前计算得出的八进制的字符串
			var bin_arr = new Array(), //存放二进制的字符数组
				tmp_bin_arr = new Array(), //存放当前3位一组二进制的数组
				oct_arr = new Array(); //存放八进制的字符数组
			bin_str = bin.value; //获取二进制字符串
			bin_arr = bin_str.split(''); //字符串转换成字符数组
			for (bin_len = 0; bin_arr[bin_len] != undefined; ++bin_len); //获取数组长度
			// alert("bin_len"+bin_len);
			for (var times = 0; times * 3 < bin_len; ++times) {
				//3个一组，times第几次分组
				var i = times * 3;
				for (var j = 0; j < 3; ++j) {
					var index = bin_len - 1 - i - j;
					// alert("index"+index);
					if (index >= 0 && index < bin_len) {
						//如果长度达到3个，自然组成一组
						tmp_bin_arr[j] = bin_arr[index];
					} else {
						//没有达到，这是二进制中空出来的高位，补0就行
						tmp_bin_arr[j] = 0;
					}
				}
				tmp_bin_str = tmp_bin_arr.reverse().join(''); //字符数组转换成字符串
				switch (
					tmp_bin_str //枚举式查找
				) {
					case '000':
						tmp_oct_str = '0';
						break;
					case '001':
						tmp_oct_str = '1';
						break;
					case '010':
						tmp_oct_str = '2';
						break;
					case '011':
						tmp_oct_str = '3';
						break;
					case '100':
						tmp_oct_str = '4';
						break;
					case '101':
						tmp_oct_str = '5';
						break;
					case '110':
						tmp_oct_str = '6';
						break;
					case '111':
						tmp_oct_str = '7';
						break;
					default:
						break;
				}
				oct_arr[times] = tmp_oct_str;
			}
			oct.value = oct_arr.reverse().join(''); //输出八进制
		}

		function bin_to_dec() {
			var bin_str,
				bin_len,
				result_dec = 0;
			var bin_arr = new Array();
			bin_str = bin.value; //获取二进制字符串
			bin_arr = bin_str.split(''); //字符串转换成字符数组
			for (bin_len = 0; bin_arr[bin_len] != undefined; ++bin_len); //获取数组长度
			if (bin_len == 0) {
				dec.value = '';
				return 0;
			}
			for (var i = 0; i < bin_len; ++i) {
				//按权相加
				// alert(power(2, bin_len - i - 1));
				result_dec =
					result_dec + power(2, bin_len - i - 1) * parseInt(bin_arr[i]);
				// alert("i="+i+", bin_len"+bin_len+", result_dec"+result_dec);
			}
			dec.value = String(result_dec); //输出十进制
		}

		function bin_to_hex() {
			var bin_str, //二进制字符串，直接来自于文本框
				bin_len, //二进制字符串的长度
				tmp_bin_str, //当前4位一组二进制的字符串
				tmp_hex_str; //当前计算得出的十六进制的字符串
			var bin_arr = new Array(), //存放二进制的字符数组
				tmp_bin_arr = new Array(), //存放当前4位一组二进制的数组
				hex_arr = new Array(); //存放十六进制的字符数组
			bin_str = bin.value; //获取二进制字符串
			bin_arr = bin_str.split(''); //字符串转换成字符数组
			for (bin_len = 0; bin_arr[bin_len] != undefined; ++bin_len); //获取数组长度
			// alert("bin_len"+bin_len);
			for (var times = 0; times * 4 < bin_len; ++times) {
				//4个一组，times第几次分组
				var i = times * 4;
				for (var j = 0; j < 4; ++j) {
					var index = bin_len - 1 - i - j;
					// alert("index"+index);
					if (index >= 0 && index < bin_len) {
						//如果长度达到4个，自然组成一组
						tmp_bin_arr[j] = bin_arr[index];
					} else {
						//没有达到，这是二进制中空出来的高位，补0就行
						tmp_bin_arr[j] = 0;
					}
					// alert("tmp_bin_arr["+j+"]"+tmp_bin_arr[j]);
				}
				tmp_bin_str = tmp_bin_arr.reverse().join(''); //字符数组转换成字符串
				// alert("tmp_bin_str"+tmp_bin_str);
				switch (
					tmp_bin_str //枚举式查找
				) {
					case '0000':
						tmp_hex_str = '0';
						break;
					case '0001':
						tmp_hex_str = '1';
						break;
					case '0010':
						tmp_hex_str = '2';
						break;
					case '0011':
						tmp_hex_str = '3';
						break;
					case '0100':
						tmp_hex_str = '4';
						break;
					case '0101':
						tmp_hex_str = '5';
						break;
					case '0110':
						tmp_hex_str = '6';
						break;
					case '0111':
						tmp_hex_str = '7';
						break;
					case '1000':
						tmp_hex_str = '8';
						break;
					case '1001':
						tmp_hex_str = '9';
						break;
					case '1010':
						tmp_hex_str = 'A';
						break;
					case '1011':
						tmp_hex_str = 'B';
						break;
					case '1100':
						tmp_hex_str = 'C';
						break;
					case '1101':
						tmp_hex_str = 'D';
						break;
					case '1110':
						tmp_hex_str = 'E';
						break;
					case '1111':
						tmp_hex_str = 'F';
						break;
					default:
						break;
				}
				// alert("tmp_hex_str"+tmp_hex_str);
				hex_arr[times] = tmp_hex_str;
			}
			hex.value = hex_arr.reverse().join(''); //输出十六进制
		}

		function oct_to_bin() {
			var oct_str, oct_len;
			var oct_arr = new Array(),
				bin_arr = new Array();
			oct_str = oct.value;
			oct_arr = oct_str.split(''); //字符串转换成字符数组
			for (oct_len = 0; oct_arr[oct_len] != undefined; ++oct_len); //获取数组长度
			for (var index = oct_len - 1; index >= 0; --index) {
				switch (oct_arr[index]) {
					case '0':
						bin_arr[index] = '000';
						break;
					case '1':
						bin_arr[index] = '001';
						break;
					case '2':
						bin_arr[index] = '010';
						break;
					case '3':
						bin_arr[index] = '011';
						break;
					case '4':
						bin_arr[index] = '100';
						break;
					case '5':
						bin_arr[index] = '101';
						break;
					case '6':
						bin_arr[index] = '110';
						break;
					case '7':
						bin_arr[index] = '111';
						break;

					default:
						break;
				}
			}
			bin.value = bin_arr.join(''); //输出二进制
		}

		function oct_to_dec() {
			oct_str = oct.value;
			bin_to_dec();
		}

		function oct_to_hex() {
			oct_str = oct.value;
			bin_to_hex();
		}

		function dec_to_bin() {
			if (dec.value == '') {
				bin.value = '';
				return 0;
			} else if (parseInt(dec.value) == 0) {
				bin.value = '0';
				return 0;
			} else if (dec.value < 0) {
				bin.value = '暂不支持负数计算。'; //TODO: To be deleted.
				return -1;
			} else if (parseInt(dec.value) > 0) {
				var dividend = parseInt(dec.value); //字符串转整型，dividend被除数
			} else {
				bin.value = '';
				return 0;
			}

			var result = dividend;

			var length = 0;
			var times = 0; //除法次数
			var j = 0;
			var array_dividendarr = new Array();
			var array_result = new Array();
			var array_remainder = new Array(); //余数

			for (times = 0; dividend != 0; ++times) {
				//dividend被除数一直除成0为止
				array_remainder[times] = dividend % 2; //取余数
				dividend = Math.floor(dividend / 2); //被除数向下取整
			}
			length = times;
			for (j = 0; j <= length; j++) {
				array_result[j] = array_remainder[length - j];
			}
			result = array_result.join('');
			bin.value = result;
		}

		function dec_to_oct() {
			bin_to_oct();
		}

		function dec_to_hex() {
			bin_to_hex();
		}

		function hex_to_bin() {
			var hex_str, hex_len;
			var hex_arr = new Array(),
				bin_arr = new Array();
			hex_str = hex.value;
			hex_arr = hex_str.split(''); //字符串转换成字符数组
			for (hex_len = 0; hex_arr[hex_len] != undefined; ++hex_len); //获取数组长度
			for (var index = hex_len - 1; index >= 0; --index) {
				switch (hex_arr[index]) {
					case '0':
						bin_arr[index] = '0000';
						break;
					case '1':
						bin_arr[index] = '0001';
						break;
					case '2':
						bin_arr[index] = '0010';
						break;
					case '3':
						bin_arr[index] = '0011';
						break;
					case '4':
						bin_arr[index] = '0100';
						break;
					case '5':
						bin_arr[index] = '0101';
						break;
					case '6':
						bin_arr[index] = '0110';
						break;
					case '7':
						bin_arr[index] = '0111';
						break;
					case '8':
						bin_arr[index] = '1000';
						break;
					case '9':
						bin_arr[index] = '1001';
						break;
					case 'A':
					case 'a':
						bin_arr[index] = '1010';
						break;
					case 'B':
					case 'b':
						bin_arr[index] = '1011';
						break;
					case 'C':
					case 'c':
						bin_arr[index] = '1100';
						break;
					case 'D':
					case 'd':
						bin_arr[index] = '1101';
						break;
					case 'E':
					case 'e':
						bin_arr[index] = '1110';
						break;
					case 'F':
					case 'f':
						bin_arr[index] = '1111';
						break;
					default:
						break;
				}
			}
			bin.value = bin_arr.join(''); //输出二进制
		}

		function hex_to_oct() {
			bin_to_oct();
		}

		function hex_to_dec() {
			bin_to_dec();
		}

		function power(x, n) {
			//y=x^n (n=0,1,2,...)
			y = 1;
			if (n >= 1) {
				for (i = 1; i <= n; ++i) y = y * x;
				return y;
			} else if (n == 0)
				//条件判断双等号！！！草（中日双语）！
				return 1;
		}
	</script>

</body>

</html>